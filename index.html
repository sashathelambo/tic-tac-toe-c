<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe Game</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .board {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-gap: 10px;
            margin: 20px auto;
        }
        
        .cell {
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2em;
            background-color: #61dafb;
            border: 2px solid #20232a;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }
        
        .cell:hover {
            background-color: #21a1f1;
            transform: scale(1.1);
        }
        
        .cell.x {
            color: #ff6b6b;
        }
        
        .cell.o {
            color: #4db6ac;
        }
        
        .active-mode {
            border: 2px solid #fff;
        }
        
        .highlight {
            background-color: #ffeb3b;
        }
        
        @media (max-width: 600px) {
            .board {
                grid-template-columns: repeat(3, 80px);
                grid-gap: 5px;
            }
            .cell {
                width: 80px;
                height: 80px;
                font-size: 1.5em;
            }
        }
    </style>
</head>

<body class="bg-gray-900 text-white flex flex-col items-center justify-center min-h-screen p-4">
    <h1 class="text-4xl font-bold text-blue-400 mb-4">Welcome to Tic-Tac-Toe!</h1>
    <div class="instructions bg-gray-800 p-6 rounded-lg shadow-lg max-w-lg text-center">
        <h2 class="text-2xl font-semibold text-blue-400 mb-4">Instructions</h2>
        <p class="mb-4">This is a web-based Tic-Tac-Toe game. Click on a cell to make a move. The first player to align three of their marks in a row, column, or diagonal wins!</p>
    </div>
    <div class="board" role="grid" aria-label="Tic-Tac-Toe Board"></div>
    <div id="message" class="text-xl mt-4" aria-live="polite"></div>
    <button id="resetBtn" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded">Reset Game</button>
    <div class="mt-4">
        <button id="playerVsPlayerBtn" class="bg-green-500 text-white px-4 py-2 rounded">Player vs Player</button>
        <button id="playerVsComputerBtn" class="bg-red-500 text-white px-4 py-2 rounded">Player vs Computer</button>
    </div>
    <div class="mt-4">
        <button id="easyBtn" class="bg-yellow-500 text-white px-4 py-2 rounded">Easy</button>
        <button id="mediumBtn" class="bg-orange-500 text-white px-4 py-2 rounded">Medium</button>
        <button id="hardBtn" class="bg-purple-500 text-white px-4 py-2 rounded">Hard</button>
    </div>
    <div class="mt-4">
        <button id="darkModeBtn" class="bg-gray-700 text-white px-4 py-2 rounded">Dark Mode</button>
        <button id="lightModeBtn" class="bg-gray-300 text-black px-4 py-2 rounded">Light Mode</button>
    </div>
    <div class="mt-4">
        <h2 class="text-2xl font-semibold text-blue-400 mb-4">Game History</h2>
        <ul id="gameHistory" class="bg-gray-800 p-6 rounded-lg shadow-lg max-w-lg text-center"></ul>
    </div>
    <footer class="mt-auto text-gray-500">
        <p>&copy; 2024 Tic-Tac-Toe Game. All rights reserved.</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.min.js"></script>
    <script src="./gameLogic.js"></script>
    <script>
        const {
            displayBoard,
            checkWin,
            isDraw,
            resetBoard,
            handlePlayerInput,
            handleComputerMove,
            findBestMoveMedium,
            findBestMove,
            minimax,
            addGameHistory,
            playSound: playSoundFromLogic,
            highlightWinningCells: highlightWinningCellsFromLogic
        } = gameLogic;

        const boardElement = document.querySelector('.board');
        const messageElement = document.getElementById('message');
        const resetBtn = document.getElementById('resetBtn');
        const playerVsPlayerBtn = document.getElementById('playerVsPlayerBtn');
        const playerVsComputerBtn = document.getElementById('playerVsComputerBtn');
        const easyBtn = document.getElementById('easyBtn');
        const mediumBtn = document.getElementById('mediumBtn');
        const hardBtn = document.getElementById('hardBtn');
        const darkModeBtn = document.getElementById('darkModeBtn');
        const lightModeBtn = document.getElementById('lightModeBtn');
        const gameHistoryElement = document.getElementById('gameHistory');

        let board = Array.from({
            length: 9
        }, (_, i) => (i + 1).toString());
        let currentPlayer = 'X';
        let isPlayerVsComputer = false;
        let difficulty = 'medium';
        let socket = io();
        let gameHistory = [];

        // Add reset event listener
        resetBtn.addEventListener('click', resetBoard);

        // Add mode selection event listeners
        playerVsPlayerBtn.addEventListener('click', () => {
            isPlayerVsComputer = false;
            resetBoard();
            playerVsPlayerBtn.classList.add('active-mode');
            playerVsComputerBtn.classList.remove('active-mode');
        });

        playerVsComputerBtn.addEventListener('click', () => {
            isPlayerVsComputer = true;
            resetBoard();
            playerVsComputerBtn.classList.add('active-mode');
            playerVsPlayerBtn.classList.remove('active-mode');
        });

        // Add difficulty selection event listeners
        easyBtn.addEventListener('click', () => {
            difficulty = 'easy';
            easyBtn.classList.add('active-mode');
            mediumBtn.classList.remove('active-mode');
            hardBtn.classList.remove('active-mode');
            isPlayerVsComputer = false;
            playerVsComputerBtn.classList.remove('active-mode');
            playerVsPlayerBtn.classList.add('active-mode');
        });

        mediumBtn.addEventListener('click', () => {
            difficulty = 'medium';
            mediumBtn.classList.add('active-mode');
            easyBtn.classList.remove('active-mode');
            hardBtn.classList.remove('active-mode');
            isPlayerVsComputer = false;
            playerVsComputerBtn.classList.remove('active-mode');
            playerVsPlayerBtn.classList.add('active-mode');
        });

        hardBtn.addEventListener('click', () => {
            difficulty = 'hard';
            hardBtn.classList.add('active-mode');
            easyBtn.classList.remove('active-mode');
            mediumBtn.classList.remove('active-mode');
            isPlayerVsComputer = false;
            playerVsComputerBtn.classList.remove('active-mode');
            playerVsPlayerBtn.classList.add('active-mode');
        });

        // Add theme selection event listeners
        darkModeBtn.addEventListener('click', () => {
            document.body.classList.add('bg-gray-900', 'text-white');
            document.body.classList.remove('bg-white', 'text-black');
        });

        lightModeBtn.addEventListener('click', () => {
            document.body.classList.add('bg-white', 'text-black');
            document.body.classList.remove('bg-gray-900', 'text-white');
        });

        // Initial display
        displayBoard();

        // Socket event listeners
        socket.on('playerMove', ({
            board: newBoard,
            currentPlayer: newCurrentPlayer
        }) => {
            board = newBoard;
            currentPlayer = newCurrentPlayer;
            displayBoard();
        });

        socket.on('resetBoard', () => {
            resetBoard();
        });

        socket.on('gameOver', (message) => {
            messageElement.textContent = message;
            playSoundFromLogic('gameOver');
        });

        // Highlight winning cells
        function highlightWinningCells(cells) {
            cells.forEach(index => {
                document.querySelector(`.cell:nth-child(${index + 1})`).classList.add('highlight');
            });
        }

        // Play sound effects
        function playSound(effect) {
            const audio = new Audio(`./sounds/${effect}.mp3`);
            audio.play();
        }

        // Testing functions
        const {
            testCheckWin,
            testIsDraw
        } = testLogic;

        // Run tests
        testCheckWin();
        testIsDraw();
    </script>
</body>

</html>

</html>