<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe Game</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .board {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-gap: 10px;
            margin: 20px auto;
        }
        
        .cell {
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2em;
            background-color: #61dafb;
            border: 2px solid #20232a;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }
        
        .cell:hover {
            background-color: #21a1f1;
            transform: scale(1.1);
        }
        
        .cell.x {
            color: #ff6b6b;
        }
        
        .cell.o {
            color: #4db6ac;
        }
    </style>
</head>

<body class="bg-gray-900 text-white flex flex-col items-center justify-center min-h-screen p-4">
    <h1 class="text-4xl font-bold text-blue-400 mb-4">Welcome to Tic-Tac-Toe!</h1>
    <div class="instructions bg-gray-800 p-6 rounded-lg shadow-lg max-w-lg text-center">
        <h2 class="text-2xl font-semibold text-blue-400 mb-4">Instructions</h2>
        <p class="mb-4">This is a console-based Tic-Tac-Toe game written in C++. Follow the instructions below to play the game:</p>
        <ol class="list-decimal list-inside mb-4 text-gray-300">
            <li>Clone the repository from GitHub: <a href="https://github.com/sashathelambo/tic-tac-toe-c" class="text-blue-400 underline">https://github.com/sashathelambo/tic-tac-toe-c</a></li>
            <li>Navigate to the directory containing the game files.</li>
            <li>Open a terminal or command prompt.</li>
            <li>Compile the source code using a C++ compiler (e.g., <code class="bg-gray-700 p-1 rounded">g++ main.cpp -o main.exe</code>).</li>
            <li>Run the executable file <code class="bg-gray-700 p-1 rounded">main.exe</code> to start the game.</li>
            <li>Follow the on-screen instructions to play against another player or the computer.</li>
            <li>Press <strong>ESC</strong> at any time to exit the game or <strong>M</strong> to return to the menu.</li>
        </ol>
        <h2 class="text-2xl font-semibold text-blue-400 mb-4">Game Features</h2>
        <ul class="list-disc list-inside text-gray-300">
            <li>Play against another player or the computer.</li>
            <li>Color-coded console output for better visibility.</li>
            <li>Simple and intuitive controls.</li>
        </ul>
    </div>
    <div id="output" class="bg-gray-800 p-4 rounded-lg shadow-lg mt-4 max-w-lg text-left text-gray-300"></div>
    <footer class="mt-auto text-gray-500">
        <p>&copy; 2024 Tic-Tac-Toe Game. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const outputDiv = document.getElementById("output");

            function appendToOutput(message) {
                const p = document.createElement("p");
                p.textContent = message;
                outputDiv.appendChild(p);
            }

            function runGame() {
                appendToOutput("Welcome to Tic-Tac-Toe! Player 1 is X, Player 2 is O. Let's begin!");
                appendToOutput("Press ESC at any time to exit the game.");
                appendToOutput("Press 'M' at any time to return to the menu.");

                let board = ["1", "2", "3", "4", "5", "6", "7", "8", "9"];
                let currentPlayer = "X";
                let exitFlag = false;
                let returnToMenuFlag = false;

                function displayBoard() {
                    let boardStr = "";
                    for (let i = 0; i < 9; i += 3) {
                        boardStr += `${board[i]} | ${board[i + 1]} | ${board[i + 2]}\n`;
                        if (i < 6) boardStr += "---------\n";
                    }
                    appendToOutput(boardStr);
                }

                function isCellTaken(pos) {
                    return board[pos - 1] === "X" || board[pos - 1] === "O";
                }

                function checkWin(marker) {
                    const winPatterns = [
                        [0, 1, 2],
                        [3, 4, 5],
                        [6, 7, 8], // rows
                        [0, 3, 6],
                        [1, 4, 7],
                        [2, 5, 8], // columns
                        [0, 4, 8],
                        [2, 4, 6] // diagonals
                    ];
                    return winPatterns.some(pattern =>
                        pattern.every(index => board[index] === marker)
                    );
                }

                function isDraw() {
                    return board.every(cell => cell === "X" || cell === "O");
                }

                function resetBoard() {
                    board = ["1", "2", "3", "4", "5", "6", "7", "8", "9"];
                }

                function getPlayerInput() {
                    return new Promise((resolve) => {
                        document.addEventListener("keydown", function onKeyPress(event) {
                            if (event.key === "Escape") {
                                exitFlag = true;
                                appendToOutput("ESC clicked. Exiting the game...");
                                document.removeEventListener("keydown", onKeyPress);
                                resolve(-1);
                            } else if (event.key.toLowerCase() === "m") {
                                returnToMenuFlag = true;
                                appendToOutput("Menu clicked. Returning to menu...");
                                document.removeEventListener("keydown", onKeyPress);
                                resolve(-1);
                            } else if (event.key >= "1" && event.key <= "9") {
                                const position = parseInt(event.key);
                                appendToOutput(event.key);
                                document.removeEventListener("keydown", onKeyPress);
                                resolve(position);
                            } else {
                                appendToOutput("Invalid input. Please enter a number between 1 and 9:");
                            }
                        });
                    });
                }

                async function playGame(isComputerOpponent) {
                    resetBoard();
                    displayBoard();

                    while (!exitFlag && !returnToMenuFlag) {
                        appendToOutput(`Player ${currentPlayer === "X" ? "1 (X)" : "2 (O)"}, choose a position (1-9):`);
                        let pos;
                        let validMove = false;

                        while (!validMove && !exitFlag && !returnToMenuFlag) {
                            if (currentPlayer === "O" && isComputerOpponent) {
                                pos = getComputerInput();
                            } else {
                                pos = await getPlayerInput();
                            }
                            if (pos === -1) break;
                            if (isCellTaken(pos)) {
                                appendToOutput("Cell already taken. Please choose another position.");
                            } else {
                                validMove = true;
                            }
                        }

                        if (exitFlag || returnToMenuFlag) break;

                        board[pos - 1] = currentPlayer;
                        displayBoard();

                        if (checkWin(currentPlayer)) {
                            appendToOutput(`Player ${currentPlayer === "X" ? "1 (X)" : "2 (O)"} wins!`);
                            break;
                        }

                        if (isDraw()) {
                            appendToOutput("It's a draw!");
                            break;
                        }

                        currentPlayer = currentPlayer === "X" ? "O" : "X";
                    }

                    if (!exitFlag && !returnToMenuFlag) {
                        appendToOutput("Press any key to continue...");
                        await new Promise(resolve => document.addEventListener("keydown", resolve, {
                            once: true
                        }));
                    }
                }

                function getComputerInput() {
                    let pos;
                    do {
                        pos = Math.floor(Math.random() * 9) + 1;
                    } while (isCellTaken(pos));
                    appendToOutput(pos);
                    return pos;
                }

                async function showMenu() {
                    appendToOutput("Do you want to play against the computer or another player?");
                    appendToOutput("1. Play against the computer");
                    appendToOutput("2. Play against another player");
                    appendToOutput("Enter your choice (1 or 2, ESC to exit or M to go back to menu):");

                    let isComputerOpponent = false;
                    let choice;
                    while (true) {
                        choice = await getPlayerInput();
                        if (choice === -1) return;
                        if (choice === 1) {
                            isComputerOpponent = true;
                            break;
                        } else if (choice === 2) {
                            isComputerOpponent = false;
                            break;
                        } else {
                            appendToOutput("Invalid choice. Please enter 1, 2, or M or ESC:");
                        }
                    }

                    while (!exitFlag && !returnToMenuFlag) {
                        if (!exitFlag && !returnToMenuFlag) {
                            await playGame(isComputerOpponent);
                        }

                        if (!exitFlag && !returnToMenuFlag) {
                            appendToOutput("Do you want to play again? (y for yes, n for no, and m for menu):");
                            let playAgain = await getPlayerInput();
                            if (playAgain === -1) return;
                            if (playAgain === 'n' || playAgain === 'N') {
                                exitFlag = true;
                            } else if (playAgain === 'm' || playAgain === 'M') {
                                returnToMenuFlag = true;
                            }
                        }
                    }
                }

                showMenu();
            }

            runGame();
        });
    </script>

</body>

</html>